!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CardDragSort={},e.Vue)}(this,(function(e,t){"use strict";var n=document.createElement("style");n.textContent=".card-drag-sort[data-v-af7b0379]{position:relative;width:100%;height:var(--22f48cc6)}.card-drag-sort .card-wrap[data-v-af7b0379]{position:absolute;display:flex;flex-direction:column;overflow:hidden;border-radius:5px;box-shadow:0 0 8px #ccc;transition:all .4s}.card-drag-sort .card-wrap .card-header[data-v-af7b0379]{height:50px;-webkit-user-select:none;user-select:none;cursor:move;border-bottom:1px solid #e0e0e0}.card-drag-sort .card-wrap .card-title[data-v-af7b0379]{line-height:49px;font-size:14px;color:gray;background-color:#fff;padding:0 15px}.card-drag-sort .card-wrap .empty-text[data-v-af7b0379]{height:100%;background-color:#fff;display:flex;justify-content:center;align-items:center;font-size:14px;color:gray}\n",document.head.appendChild(n);const o=["id","tabIndex"],d=["onMousedown"],r={class:"card-title"},a=(e=>(t.pushScopeId("data-v-af7b0379"),e=e(),t.popScopeId(),e))((()=>t.createElementVNode("div",{class:"empty-text"},"暂无内容",-1))),i=((e,t)=>{const n=e.__vccOpts||e;for(const[o,d]of t)n[o]=d;return n})(t.defineComponent({name:"CardDragSort",__name:"index",props:{data:{type:Array,required:!0},columns:{type:Number,default:3},width:{type:Number,default:500},height:{type:Number,default:300},columnSpace:{type:Number,default:20},rowSpace:{type:Number,default:20}},emits:["dragStart","dragStop"],setup(e,{emit:n}){t.useCssVars((e=>({"22f48cc6":s.value})));const i=n,l=e,c=t.computed((()=>l.data.map(((e,t)=>({index:t,...e}))))),s=t.computed((()=>{const e=c.value.length;return Math.ceil(e/l.columns-1)*(l.height+l.rowSpace)+l.height+"px"}));function u(e){return Math.floor(e/l.columns)*(l.height+l.rowSpace)+"px"}function p(e){return e%l.columns*(l.width+l.columnSpace)+"px"}let f,m,x,y,h,g,v,b,E=0,w=0,S=0;function I(e){E=x+(e.clientY-h),w=y+(e.clientX-g),f.style.top=E+S+"px",f.style.left=w+"px",b=setTimeout((()=>{!function(e,t){const n=Array.from(k.value.children);for(const o of n){const n=e-parseInt(o.style.top),d=t-parseInt(o.style.left);if(Math.abs(n)<l.height/2&&Math.abs(d)<l.width/2&&m&&o.id!==m.id){const e=c.value.find((e=>o.id===e.id));if(!e||e.id===m.id)return;const t=e.index,n=m.index>e.index;if(n){let n=c.value.filter((t=>{if(t.index>=e.index&&t.index<m.index)return t.index+=1,t}));m.index=t;for(const e of n){const t=document.getElementById(e.id);t&&(t.style.top=u(e.index),t.style.left=p(e.index))}}if(!n){let n=c.value.filter((t=>{if(t.index<=e.index&&t.index>m.index)return t.index-=1,t}));m.index=t;for(const e of n){const t=document.getElementById(e.id);t&&(t.style.top=u(e.index),t.style.left=p(e.index))}}}}}(parseInt(f.style.top),parseInt(f.style.left)),clearTimeout(b)}),400)}const k=t.ref();function _(){i("dragStop"),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",_),document.removeEventListener("scroll",B),f.style.transition="all 0.4s",f.style.top=x+"px",f.style.left=y+"px",f.style.zIndex="0",f.style.top=u(m.index),f.style.left=p(m.index),M()}function B(){S=document.documentElement.scrollTop-v,f.style.top=E+S+"px"}function M(){t.nextTick((()=>{c.value.forEach((e=>{const t=document.getElementById(e.id);t&&(t.style.top=u(e.index),t.style.left=p(e.index))}))}))}return t.watch(c,(()=>{M()}),{immediate:!0}),(n,l)=>(t.openBlock(),t.createElementBlock("div",{class:"card-drag-sort",ref_key:"cardDrag",ref:k},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.value,(l=>(t.openBlock(),t.createElementBlock("div",{class:"card-wrap",key:l.id,id:l.id,tabIndex:l.index,style:t.normalizeStyle({width:`${e.width}px`,height:`${e.height}px`,top:u(l.index),left:p(l.index)})},[t.createElementVNode("div",{class:"card-header",onMousedown:e=>function(e,t){i("dragStart",t);const n=document.getElementById(t);n&&(f=n,m=c.value.find((e=>e.id===t)),x=parseInt(f.style.top),y=parseInt(f.style.left),f.style.zIndex="100",f.style.transition="none",h=e.clientY,g=e.clientX,v=document.documentElement.scrollTop,document.addEventListener("mousemove",I),document.addEventListener("mouseup",_),document.addEventListener("scroll",B))}(e,l.id)},[t.renderSlot(n.$slots,"header",{item:l},(()=>[t.createElementVNode("div",r,t.toDisplayString(l.title||"无标题"),1)]),!0)],40,d),t.renderSlot(n.$slots,"content",{item:l},(()=>[a]),!0)],12,o)))),128))],512))}}),[["__scopeId","data-v-af7b0379"]]),l=[i];e.CardDragSort=i,e.default=e=>{l.forEach((t=>{e.component(t.__name,t)}))},Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
